// npx prisma migrate dev --name 'init' --preview-feature
// npx prisma db push --preview-feature (only to fix shadow db issue)
// npx prisma generate

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Restaurant {
  id               Int      @id @default(autoincrement())
  createdAt        DateTime @default(now())
  name             String   @unique
  url              String
  image            String   @default("https://images.unsplash.com/photo-1428515613728-6b4607e44363?ixid=MXwxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHw%3D&ixlib=rb-1.2.1&auto=format&fit=crop&w=1950&q=80")
  description      String
  happyHourDays    String
  price            Int
  menu             String
  cuisine          Cuisine
  goFor            String[]
  when             String
  startTime        String
  endTime          String
  percentOffDrinks Int
  percentOffFood   Int
  coordinates      Json?
  address          String
  votes            Vote[]
  createdBy        User?    @relation(fields: [createdByID], references: [id])
  createdByID      Int?
}

model User {
  id          Int          @id @default(autoincrement())
  name        String
  email       String       @unique
  role        Role         @default(USER)
  password    String
  restaurants Restaurant[]
  votes       Vote[]
}

model Vote {
  id            Int        @id @default(autoincrement())
  restaurant    Restaurant @relation(fields: [restaurauntID], references: [id])
  restaurauntID Int
  user          User       @relation(fields: [userID], references: [id])
  userID        Int

  @@unique([restaurauntID, userID])
}

enum Role {
  USER
  ADMIN
}

enum Cuisine {
  JAPANESE
  AMERICAN
  CHINESE
  INDIAN
  MEXICAN
  ITALIAN
}
